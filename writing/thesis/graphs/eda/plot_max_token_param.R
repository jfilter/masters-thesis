library(tidyverse)
library(RColorBrewer)

# for all language model data

df<- read.table(text = "
max_vocab share
10000 0.9488197138035203
10100 0.9492529415562374
                10200 0.9496796736651947
                10300 0.9500995140545531
                10400 0.9505121458636414
                10500 0.9509190741806478
                10600 0.9513199029297333
                10700 0.9517155034777439
                10800 0.952103657799981
                10900 0.9524866631363107
                11000 0.9528643610563976
                11100 0.9532366723450739
                11200 0.953603042496165
                11300 0.953963788370342
                11400 0.9543202566254576
                11500 0.9546694370851353
                11600 0.9550156073684365
                11700 0.9553562325899914
                11800 0.9556921049014782
                11900 0.9560248086062527
                12000 0.956351571173442
                12100 0.9566761157159328
                12200 0.9569929763871468
                12300 0.9573089656915148
                12400 0.9576179048459483
                12500 0.9579251012666902
                12600 0.9582261189043433
                12700 0.958524918517298
                12800 0.9588180146381708
                12900 0.959108179797835
                13000 0.9593933544019274
                13100 0.9596779744998454
                13200 0.9599552275871575
                13300 0.9602324806744696
                13400 0.9605049016365458
                13500 0.9607742332070776
                13600 0.9610410298922396
                13700 0.9613024399459911
                13800 0.9615638499997425
                13900 0.9618197942069155
                14000 0.9620732827438867
                14100 0.9623265336353544
                14200 0.9625721006555451
                14300 0.9628176676757358
                14400 0.9630599868740467
                14500 0.9632976323774571
                14600 0.9635352778808676
                14700 0.9637695963472301
                14800 0.9639993203338603
                14900 0.9642290443204903
                15000 0.9644568671430931
                15100 0.9646786696129428
                15200 0.9649004720827925
                15300 0.965121165540293
                15400 0.9653350464933623
                15500 0.9655489274464317
                15600 0.9657628083995011
                15700 0.9659709066453208
                15800 0.9661768660816098
                15900 0.9663828255178989
                16000 0.9665887849541879
                16100 0.9667879318860458
                16200 0.9669859698055545
                16300 0.9671840077250632
                16400 0.9673790354681953
                16500 0.9675691518709236
                16600 0.967759268273652
                16700 0.9679493846763803
                16800 0.9681379167757526
                16900 0.9683201116617005
                17000 0.9685023065476486
                17100 0.9686845014335965
                17200 0.9688666963195445
                17300 0.9690424747769004
                17400 0.9692167481460681
                17500 0.9693910215152356
                17600 0.9695652948844032
                17700 0.9697384592412217
                17800 0.9699048110936089
                17900 0.9700711629459963
                18000 0.9702375147983835
                18100 0.9704038666507708
                18200 0.9705649110869152
                18300 0.9707233414225223
                18400 0.9708817717581292
                18500 0.9710402020937361
                18600 0.971198632429343
                18700 0.9713545278795803
                18800 0.9715050366984068
                18900 0.9716555455172334
                19000 0.97180605433606
                19100 0.9719565631548867
                19200 0.9721070719737133
                19300 0.972251877300458
                19400 0.9723944646025042
                19500 0.9725370519045504
                19600 0.9726796392065967
                19700 0.9728222265086429
                19800 0.9729648138106892
                19900 0.9731005886083044
                20000 0.9732352543935703
                20100 0.9733699201788362
                20200 0.973504585964102
                20300 0.9736392517493679
                20400 0.9737739175346338
                20500 0.9739084248895642
                20600 0.9740351691580497
                20700 0.9741619134265352
                20800 0.9742886576950208
                20900 0.9744154019635064
                21000 0.9745421462319919
                21100 0.9746688905004774
                21200 0.974795634768963
                21300 0.9749188935700652
                21400 0.9750377163217704
                21500 0.9751565390734757
                21600 0.9752753618251808
                21700 0.9753941845768861
                21800 0.9755130073285913
                21900 0.9756318300802964
                22000 0.9757506528320017
                22100 0.9758693963685391
                22200 0.9759802976034639
                22300 0.9760911988383888
                22400 0.9762021000733136
                22500 0.9763130013082385
                22600 0.9764239025431634
                22700 0.9765348037780882
                22800 0.9766457050130131
                22900 0.9767566062479379
                23000 0.9768652102429964
                23100 0.976968189961141
                23200 0.9770711696792855
                23300 0.97717414939743
                23400 0.9772771291155745
                23500 0.9773801088337191
                23600 0.9774830885518636
                23700 0.977586068270008
                23800 0.9776890479881526
                23900 0.9777920277062971
                24000 0.9778950074244416
                24100 0.9779916499291619
                24200 0.978086708130526
                24300 0.9781817663318901
                24400 0.9782768245332544
                24500 0.9783718827346185
                24600 0.9784669409359826
                24700 0.9785619991373469
                24800 0.978657057338711
                24900 0.9787521155400751
                25000 0.9788471737414394
                25100 0.9789422319428035
                25200 0.9790309529307434
                25300 0.9791180896153272
                25400 0.979205226299911
                25500 0.9792923629844948
                25600 0.9793794996690787
                25700 0.9794666363536625
                25800 0.9795537730382463
                25900 0.9796409097228301
                26000 0.979728046407414
                26100 0.9798151830919978
                26200 0.9799023197765815
                26300 0.9799894564611653
                26400 0.980076276285078
                26500 0.9801554914528814
                26600 0.9802347066206849
                26700 0.9803139217884884
                26800 0.9803931369562918
                26900 0.9804723521240953
                27000 0.9805515672918987
                27100 0.9806307824597023
                27200 0.9807099976275058
                27300 0.9807892127953092
                27400 0.9808684279631127
                27500 0.9809476431309161
                27600 0.9810268582987196
                27700 0.9811060734665231
                27800 0.9811852886343265
                27900 0.9812605430437399
                28000 0.981331836694763
                28100 0.9814031303457861
                28200 0.9814744239968092
                28300 0.9815457176478324
                28400 0.9816170112988555
                28500 0.9816883049498786
                28600 0.9817595986009017
                28700 0.9818308922519249
                28800 0.981902185902948
                28900 0.9819734795539711
                29000 0.9820447732049942
                29100 0.9821160668560174
                29200 0.9821873605070405
                29300 0.9822586541580636
                29400 0.9823299478090867
                29500 0.9824012414601098
                29600 0.9824722182504617
                29700 0.9825355903847045
                29800 0.9825989625189473
                29900 0.9826623346531901
                30000 0.9827257067874329
                30100 0.9827890789216756
                30200 0.9828524510559183
                30300 0.9829158231901611
                30400 0.9829791953244039
                30500 0.9830425674586467
                30600 0.9831059395928895
                30700 0.9831693117271323
                30800 0.9832326838613751
                30900 0.9832960559956179
                31000 0.9833594281298605
                31100 0.9834228002641033
                31200 0.9834861723983461
                31300 0.9835495445325889
                31400 0.9836129166668317
                31500 0.9836762888010745
                31600 0.9837396609353173
                31700 0.9838030330695601
                31800 0.9838602264207141
                31900 0.9839156770381766
                32000 0.983971127655639
                32100 0.9840265782731015
                32200 0.9840820288905638
                32300 0.9841374795080263
                32400 0.9841929301254887
                32500 0.9842483807429512
                32600 0.9843038313604136
                32700 0.984359281977876
                32800 0.9844147325953384
                32900 0.9844701832128009
                33000 0.9845256338302633
                33100 0.9845810844477257
                33200 0.9846365350651881
                33300 0.9846919856826506
                33400 0.984747436300113
                33500 0.9848028869175754
                33600 0.9848583375350378
                33700 0.9849137881525003
                33800 0.9849692387699627
                33900 0.9850246893874252
                34000 0.9850801400048875
                34100 0.98513559062235
                34200 0.9851858130387374
                34300 0.9852333421394195
                34400 0.9852808712401016
                34500 0.9853284003407836
                34600 0.9853759294414657
                34700 0.9854234585421479
                34800 0.9854709876428299
                34900 0.985518516743512
                35000 0.985566045844194
                35100 0.9856135749448761
                35200 0.9856611040455582
                35300 0.9857086331462404
                35400 0.9857561622469224
                35500 0.9858036913476045
                35600 0.9858512204482865
                35700 0.9858987495489686
                35800 0.9859462786496507
                35900 0.9859938077503329
                36000 0.9860413368510149
                36100 0.986088865951697
                36200 0.986136395052379
                36300 0.9861839241530611
                36400 0.9862314532537432
                36500 0.9862789823544253
                36600 0.9863265114551074
                36700 0.9863740405557895
                36800 0.9864215696564715
                36900 0.9864690987571536
                37000 0.9865166278578357
                37100 0.9865641569585177
                37200 0.9866116860591999
                37300 0.9866526403009542
                37400 0.986692247884856
                37500 0.9867318554687577
                37600 0.9867714630526595
                37700 0.9868110706365613
                37800 0.9868506782204629
                37900 0.9868902858043647
                38000 0.9869298933882664
                38100 0.9869695009721682
                38200 0.9870091085560699
                38300 0.9870487161399716
                38400 0.9870883237238733
                38500 0.9871279313077751
                38600 0.9871675388916769
                38700 0.9872071464755786
                38800 0.9872467540594803
                38900 0.987286361643382
                39000 0.9873259692272838
                39100 0.9873655768111855
                39200 0.9874051843950873
                39300 0.9874447919789889
                39400 0.9874843995628907
                39500 0.9875240071467924
                39600 0.9875636147306942
                39700 0.987603222314596
                39800 0.9876428298984976
                39900 0.9876824374823994
                40000 0.9877220450663011
                40100 0.9877616526502029
                40200 0.9878012602341046
                40300 0.9878408678180063
                40400 0.987880475401908
                40500 0.9879200829858098
                40600 0.9879596905697116
                40700 0.9879992981536133
                40800 0.988038905737515
                40900 0.9880785133214167
                41000 0.9881181209053185
                41100 0.9881577284892202
                41200 0.9881970192124507
                41300 0.9882287052795721
                41400 0.9882603913466935
                41500 0.9882920774138149
                41600 0.9883237634809363
                41700 0.9883554495480577
                41800 0.9883871356151791
                41900 0.9884188216823004
                42000 0.9884505077494218
                42100 0.9884821938165432
                42200 0.9885138798836646
                42300 0.988545565950786
                42400 0.9885772520179074
                42500 0.9886089380850288
                42600 0.9886406241521501
                42700 0.9886723102192716
                42800 0.9887039962863929
                42900 0.9887356823535143
                43000 0.9887673684206357
                43100 0.9887990544877571
                43200 0.9888307405548785
                43300 0.9888624266219999
                43400 0.9888941126891213
                43500 0.9889257987562426
                43600 0.988957484823364
                43700 0.9889891708904854
                43800 0.9890208569576068
                43900 0.9890525430247282
                44000 0.9890842290918496
                44100 0.989115915158971
                44200 0.9891476012260924
                44300 0.9891792872932138
                44400 0.9892109733603351
                44500 0.9892426594274565
                44600 0.9892743454945779
                44700 0.9893060315616993
                44800 0.9893377176288207
                44900 0.9893694036959421
                45000 0.9894010897630635
                45100 0.9894327758301849
                45200 0.9894644618973063
                45300 0.9894961479644276
                45400 0.989527834031549
                45500 0.9895595200986704
                45600 0.9895912061657918
                45700 0.9896228922329132
                45800 0.9896545783000346
                45900 0.989686264367156
                46000 0.9897179504342773
                46100 0.9897496365013987
                46200 0.9897813225685201
                46300 0.9898130086356415
                46400 0.9898446947027629
                46500 0.9898763807698843
                46600 0.9899080668370057
                46700 0.9899397529041271
                46800 0.9899714389712485
                46900 0.9900031250383698
                47000 0.9900348111054912
                47100 0.9900664971726126
                47200 0.9900952522785252
                47300 0.9901190168288663
                47400 0.9901427813792074
                47500 0.9901665459295484
                47600 0.9901903104798895
                47700 0.9902140750302305
                47800 0.9902378395805715
                47900 0.9902616041309126
                48000 0.9902853686812536
                48100 0.9903091332315946
                48200 0.9903328977819357
                48300 0.9903566623322767
                48400 0.9903804268826177
                48500 0.9904041914329588
                48600 0.9904279559832999
                48700 0.990451720533641
                48800 0.990475485083982
                48900 0.990499249634323
                49000 0.990523014184664
                49100 0.9905467787350051
                49200 0.9905705432853461
                49300 0.9905943078356871
                49400 0.9906180723860282
                49500 0.9906418369363692
                49600 0.9906656014867102
                49700 0.9906893660370513
                49800 0.9907131305873923
                49900 0.9907368951377334
                50000 0.9907606596880745
                50100 0.9907844242384155
                50200 0.9908081887887565
                50300 0.9908319533390976
                50400 0.9908557178894386
                50500 0.9908794824397796
                50600 0.9909032469901207
                50700 0.9909270115404617
                50800 0.9909507760908027
                50900 0.9909745406411438
                51000 0.9909983051914848
                51100 0.9910220697418259
                51200 0.991045834292167
                51300 0.991069598842508
                51400 0.991093363392849
                51500 0.9911171279431901
                51600 0.9911408924935311
                51700 0.9911646570438721
                51800 0.9911884215942132
                51900 0.9912121861445542
                52000 0.9912359506948952
                52100 0.9912597152452363
                52200 0.9912834797955773
                52300 0.9913072443459183
                52400 0.9913310088962595
                52500 0.9913547734466005
                52600 0.9913785379969415
                52700 0.9914023025472826
                52800 0.9914260670976236
                52900 0.9914498316479646
                53000 0.9914735961983057
                53100 0.9914973607486467
                53200 0.9915211252989877
                53300 0.9915448898493288
                53400 0.9915686543996698
                53500 0.9915924189500108
                53600 0.991616183500352
                53700 0.991639948050693
                53800 0.991663712601034
                53900 0.9916874771513751
                54000 0.9917112417017161
                54100 0.9917350062520571
                54200 0.9917587708023982
                54300 0.9917825353527392
                54400 0.9918062999030802
                54500 0.9918300644534213
                54600 0.9918538290037623
                54700 0.9918775935541033
                54800 0.9919013581044444
                54900 0.9919251226547855
                55000 0.9919488872051265
                55100 0.9919726517554676
                55200 0.9919964163058086
                55300 0.9920201808561496
                55400 0.9920439454064907
                55500 0.9920677099568317
                55600 0.9920914745071727
                55700 0.9921152390575138
                55800 0.9921390036078548
                55900 0.9921627681581958
                56000 0.9921865327085369
                56100 0.992210297258878
                56200 0.992234061809219
                56300 0.9922578263595601
                56400 0.9922815909099011
                56500 0.9923053554602421
                56600 0.9923222282909843
                56700 0.992338071324545
                56800 0.9923539143581056
                56900 0.9923697573916663
                57000 0.992385600425227
                57100 0.9924014434587877
                57200 0.9924172864923484
                57300 0.9924331295259091
                57400 0.9924489725594698
                57500 0.9924648155930305
                57600 0.9924806586265912
                57700 0.9924965016601519
                57800 0.9925123446937125
                57900 0.9925281877272732
                58000 0.992544030760834
                58100 0.9925598737943947
                58200 0.9925757168279553
                58300 0.992591559861516
                58400 0.9926074028950768
                58500 0.9926232459286374
                58600 0.9926390889621981
                58700 0.9926549319957588
                58800 0.9926707750293196
                58900 0.9926866180628802
                59000 0.9927024610964409
                59100 0.9927183041300016
                59200 0.9927341471635623
                59300 0.992749990197123
                59400 0.9927658332306837
                59500 0.9927816762642444
                59600 0.992797519297805
                59700 0.9928133623313657
                59800 0.9928292053649265
                59900 0.9928450483984872
                60000 0.9928608914320478
                ", header = TRUE, sep = "")


ggplot(data=df, aes(x=dose, y=len, group=1)) +
  geom_line()+
  geom_point()

# Basic barplot
p<- ggplot(df, aes(x=max_vocab, y=share)) +
  geom_line(size=2 ,color=brewer.pal(7,"Blues")[4]) + theme_bw(base_size = 16) + 
  theme(panel.grid.minor = element_blank()) +
  coord_cartesian(ylim = c(0.9488197138035203, 1)) +
  scale_x_continuous(breaks = seq(10000, 60000, by = 10000)) +
  ylab("Share") + xlab("Vocabulary Size")
  
p

ggsave('max_vocab.pdf', plot = last_plot(),
       scale = 1, width = 6, height = 3,
       dpi = 300)

